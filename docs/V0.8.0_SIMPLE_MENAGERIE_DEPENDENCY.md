# MuJoCo Menagerie as Model Dependency - Simplified v0.8.0

## Core Concept

MuJoCo Menagerie = Model Library (like a package of 3D models)  
MuJoCo MCP = Control Interface (loads and controls those models)

```
pip install mujoco-mcp[menagerie]
# Automatically gets Menagerie models as dependency
```

## Simple Implementation

### 1. Add Menagerie as Dependency

```toml
# pyproject.toml
[project.optional-dependencies]
menagerie = [
    "mujoco-menagerie",  # If available on PyPI
    # OR handle via setup script
]
```

### 2. Model Loader Enhancement

```python
# Current (v0.7.1)
def _handle_create_scene(self, scene_type: str):
    if scene_type == "pendulum":
        xml = self._generate_pendulum_xml()
    # ... other simple scenes

# New (v0.8.0)  
def _handle_create_scene(self, scene_type: str):
    # Check if it's a Menagerie model
    if self.menagerie_manager.has_model(scene_type):
        xml = self.menagerie_manager.load_model_xml(scene_type)
    else:
        # Fall back to built-in scenes
        xml = self._generate_scene_xml(scene_type)
```

### 3. Minimal Menagerie Manager

```python
class MenagerieManager:
    def __init__(self, menagerie_path: str = None):
        # Use environment variable or default path
        self.path = menagerie_path or os.getenv(
            "MENAGERIE_PATH", 
            "~/.mujoco/menagerie"
        )
        self.available_models = self._scan_models()
    
    def has_model(self, name: str) -> bool:
        return name in self.available_models
    
    def load_model_xml(self, name: str) -> str:
        xml_path = self.available_models[name]
        return open(xml_path).read()
    
    def list_models(self) -> List[str]:
        return list(self.available_models.keys())
```

### 4. Natural Language Updates

```python
# execute_command enhancement
if "load" in command_lower:
    # Try to extract model name
    # "load franka panda" -> "franka_panda"
    model_name = extract_model_name(command)
    
    if self.menagerie_manager.has_model(model_name):
        return self._handle_create_scene(model_name)
```

## User Experience

### Before v0.8.0
```
User: "create pendulum"  ✓
User: "create franka panda"  ✗ (not available)
```

### After v0.8.0
```
User: "create pendulum"  ✓ (built-in)
User: "create franka panda"  ✓ (from Menagerie)
User: "load spot robot"  ✓ (from Menagerie)
User: "show available robots"  ✓ (lists all models)
```

## Installation Approaches

### Option A: Git Submodule
```bash
# In mujoco-mcp repo
git submodule add https://github.com/google-deepmind/mujoco_menagerie.git
git submodule update --init
```

### Option B: Download During Setup
```python
# In setup.py or install script
def download_menagerie():
    if not os.path.exists("~/.mujoco/menagerie"):
        print("Downloading MuJoCo Menagerie models...")
        # Clone or download archive
```

### Option C: User Provides Path
```python
# In config
export MUJOCO_MENAGERIE_PATH=/path/to/menagerie
```

## Minimal Changes Required

### 1. Add to `remote_server.py`
```python
def __init__(self):
    # ... existing init
    self.menagerie = MenagerieManager()
```

### 2. Update `_handle_create_scene`
```python
# Add Menagerie model check
if self.menagerie.has_model(scene_type):
    return self._create_from_menagerie(scene_type)
```

### 3. Add New Tool
```python
self._tools["list_available_models"] = {
    "name": "list_available_models",
    "description": "List all available models including Menagerie",
    "handler": self._handle_list_models
}
```

## Benefits of This Approach

1. **Simple**: Menagerie is just a model source
2. **Optional**: Works without Menagerie (falls back to built-in)
3. **Extensible**: Easy to add more model sources
4. **Maintainable**: No deep integration needed
5. **User-Friendly**: Transparent to end users

## What We DON'T Need to Do

- ❌ Rewrite our architecture
- ❌ Deep integration with Menagerie code
- ❌ Complex model management system
- ❌ Modify Menagerie models

## Testing

```python
def test_menagerie_models():
    server = MuJoCoRemoteServer()
    
    # Test model listing
    models = server.menagerie.list_models()
    assert "franka_panda" in models
    
    # Test model loading
    result = server._handle_create_scene("franka_panda")
    assert "model_id" in result
    
    # Test fallback
    result = server._handle_create_scene("pendulum")
    assert "model_id" in result  # Still works
```

## Summary

MuJoCo Menagerie integration is simply:
1. **Add as dependency** (like any Python package)
2. **Check if requested model exists** in Menagerie
3. **Load it** if yes, use built-in if no
4. **No architectural changes** needed

This keeps v0.8.0 focused and achievable in 2-3 weeks instead of 5-6.