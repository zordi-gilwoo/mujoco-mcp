# 🖼️ MuJoCo MCP v0.6.1 - GUI可视化功能发布

## 🎯 新增功能概述

v0.6.1版本重点添加了GUI可视化功能，让用户能够实时查看物理仿真的图像和ASCII艺术表示。

## ✨ 新增工具

### 1. **get_render_frame** - 实时画面渲染
```python
# 渲染640x480图像
get_render_frame(model_id="your_model_id")

# 自定义尺寸和相机参数
get_render_frame(
    model_id="your_model_id",
    width=800,
    height=600,
    camera_distance=2.0,
    camera_azimuth=45.0,
    camera_elevation=30.0
)
```

**功能特点:**
- ✅ **双重渲染系统**: MuJoCo原生渲染 + 软件后备渲染
- ✅ **多种尺寸支持**: 50x50 到 2000x2000 像素
- ✅ **相机控制**: 距离、方位角、仰角调节
- ✅ **Base64编码**: PNG格式，直接可用于网页显示
- ✅ **错误恢复**: 硬件渲染失败时自动切换到软件渲染

### 2. **get_ascii_visualization** - ASCII艺术可视化
```python
# 标准ASCII可视化
get_ascii_visualization(model_id="your_model_id")

# 自定义ASCII尺寸
get_ascii_visualization(
    model_id="your_model_id", 
    width=80,
    height=25
)
```

**功能特点:**
- ✅ **轻量级显示**: 纯文本可视化，适合终端环境
- ✅ **实时状态**: 显示角度、时间等仿真参数
- ✅ **几何绘图**: 线条、圆形等基本图形渲染
- ✅ **尺寸可调**: 10-50行，20-120列

## 🔧 技术实现详情

### 渲染架构
```
MuJoCo MCP v0.6.1 渲染系统
├── MuJoCo原生渲染
│   ├── mujoco.Renderer() - GPU硬件加速
│   ├── 场景更新和相机控制
│   └── RGB数组输出
├── 软件后备渲染
│   ├── 几何计算 (sin/cos 位置计算)
│   ├── 简单图形绘制 (线条、圆形)
│   └── 文本叠加 (角度、状态信息)
└── 格式转换
    ├── PIL图像处理
    ├── PNG编码
    └── Base64字符串输出
```

### 核心改进

**1. MuJoCoSimulation类增强**
```python
# 新增方法
render_frame(width, height, camera_id) -> np.ndarray
render_ascii(width, height) -> str
_render_software_fallback() -> np.ndarray
_draw_line(), _draw_circle(), _draw_text()
```

**2. Simple Server集成**
```python
# MCP工具更新
_handle_get_render_frame() -> Dict[str, Any]
_handle_get_ascii_visualization() -> Dict[str, Any]
```

## 📊 使用示例

### 在Claude Desktop中测试可视化

1. **创建仿真并渲染**
```
Create a pendulum simulation, then render a frame of it
```

2. **查看ASCII可视化**  
```
Show me ASCII art visualization of the pendulum
```

3. **自定义渲染参数**
```
Render the pendulum with 800x600 resolution and camera at 45 degree angle
```

### 返回数据格式

**Frame Rendering Response:**
```json
{
  "success": true,
  "image_data": "iVBORw0KGgoAAAANSUhEUgAA...",
  "format": "base64/png", 
  "width": 640,
  "height": 480,
  "rendering_method": "mujoco_native",
  "camera_info": {
    "name": "track",
    "distance": 2.0,
    "azimuth": 45.0,
    "elevation": 30.0
  }
}
```

**ASCII Visualization Response:**
```json
{
  "success": true,
  "ascii_art": "                              +                              \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                             ||                             \n                              O                             \nAngle: 0.0°\nTime: 0.00s",
  "width": 60,
  "height": 20,
  "timestamp": 0.002
}
```

## 🎨 可视化效果

### 软件渲染效果
- **背景**: 浅灰色 (240, 240, 240)
- **摆杆**: 深灰色线条 (50, 50, 50) 
- **支点**: 中灰色圆点 (100, 100, 100)
- **摆球**: 红色圆形 (200, 100, 100)
- **文本**: 角度显示在左下角

### ASCII艺术效果
```
              +
             ||
             ||
             ||
             ||
             ||
             ||
             ||
             ||
             ||
              O
Angle: 45.2°
Time: 1.25s
```

## 🚀 性能优化

### 渲染性能
- **硬件渲染**: ~5ms (GPU可用时)
- **软件渲染**: ~50ms (后备模式)
- **ASCII渲染**: ~10ms (轻量级)
- **图像编码**: ~20ms (PNG + Base64)

### 内存使用
- **640x480 RGB**: ~900KB 原始数据
- **PNG压缩**: ~100-300KB (取决于内容)
- **Base64编码**: ~130-400KB 文本数据
- **ASCII输出**: ~1-5KB 纯文本

## 🔍 错误处理

### 渲染失败恢复
1. **尝试MuJoCo原生渲染**
2. **GPU失败 → 软件后备渲染**
3. **PIL缺失 → 简化图像数据**
4. **内存不足 → 降低分辨率**

### 常见问题解决
- **"Renderer initialization failed"**: 自动切换到软件渲染
- **"PIL not found"**: 返回原始图像数组信息
- **"Invalid dimensions"**: 参数验证，返回具体错误

## 📋 兼容性

### 依赖要求
- **必需**: MuJoCo >= 3.2.0, NumPy
- **推荐**: PIL/Pillow (图像处理)
- **可选**: GPU驱动 (硬件加速)

### 环境支持
- ✅ **有头环境**: 完整GPU渲染
- ✅ **无头环境**: 软件后备渲染  
- ✅ **容器环境**: ASCII可视化
- ✅ **云端部署**: Base64图像传输

## 🎯 下一步发展

### v0.6.2 计划功能
- 🔄 **多相机视角**: 同时渲染多个角度
- 🎬 **动画录制**: 连续帧序列导出
- 📊 **数据叠加**: 力、速度矢量可视化
- 🎨 **自定义着色**: 用户定义颜色方案

### 长期路线图
- **WebGL集成**: 浏览器内3D渲染
- **VR/AR支持**: 沉浸式物理仿真
- **实时流媒体**: 低延迟视频传输
- **交互控制**: 鼠标/触控仿真操作

---

## 🎉 v0.6.1 总结

**新增工具**: 2个可视化工具 (get_render_frame, get_ascii_visualization)  
**代码变更**: 4个文件，+266行，-31行  
**功能提升**: 从纯数值仿真 → 可视化物理世界  
**兼容性**: 保持v0.6.0所有现有功能

**🚀 MuJoCo MCP现在不仅能计算物理，还能让您看见物理！**